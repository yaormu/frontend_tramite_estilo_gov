{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import React, { useState } from 'react'\n// import styles from './styles.module.css'\n\nfunction createInputComponent({ multiple, accept }) {\n  const el = document.createElement('input')\n  // set input config\n  el.type = 'file'\n  el.accept = accept\n  el.multiple = multiple\n  // return file input element\n  return el\n}\n\nexport const useFileUpload = () => {\n  const [files, setFiles] = useState(null)\n  let userCallback = () => {}\n\n  // Handle onChange event\n  const onChange = async (e) => {\n    const parsedFiles = []\n    const target = e.target\n\n    // Loop through files\n    for (const fileIndex in target.files) {\n      // check if index is a number\n      if (isNaN(fileIndex)) {\n        continue\n      }\n\n      // get file object\n      const file = target.files[fileIndex]\n\n      // select properties\n\n      const parsedFile = {\n        source: URL.createObjectURL(file),\n        name: file.name,\n        size: file.size,\n        file // original file object\n      }\n\n      // add to parsed file list\n      parsedFiles.push(parsedFile)\n    }\n\n    // remove event listener after operation\n    target.removeEventListener('change', onChange)\n\n    // remove input element after operation\n    target.remove()\n\n    // update files state hook\n\n    if (target.multiple) {\n      setFiles(parsedFiles)\n      return userCallback(parsedFiles)\n    }\n\n    setFiles(parsedFiles[0])\n    return userCallback(parsedFiles[0])\n\n    // user specified callback\n  }\n\n  // Handle upload\n  const uploadFile = (\n    { accept, multiple } = { accept: '', multiple: false },\n    cb\n  ) => {\n    if (typeof cb === 'function') {\n      userCallback = cb\n    }\n    // create virtual input element\n    const inputEL = createInputComponent({ multiple, accept })\n    // add event listener\n    inputEL.addEventListener('change', onChange)\n    inputEL.click()\n  }\n\n  return React.useMemo(() => [files, uploadFile], [files])\n}\n"],"names":["createInputComponent","multiple","accept","el","document","createElement","type","useFileUpload","useState","files","setFiles","userCallback","onChange","e","parsedFiles","target","fileIndex","isNaN","file","parsedFile","source","URL","createObjectURL","name","size","push","removeEventListener","remove","uploadFile","cb","inputEL","addEventListener","click","React","useMemo"],"mappings":";;;;;AAGA,SAASA,oBAAT,OAAoD;AAAA,MAApBC,QAAoB,QAApBA,QAAoB;AAAA,MAAVC,MAAU,QAAVA,MAAU;AAClD,MAAMC,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAX;AAEAF,EAAAA,EAAE,CAACG,IAAH,GAAU,MAAV;AACAH,EAAAA,EAAE,CAACD,MAAH,GAAYA,MAAZ;AACAC,EAAAA,EAAE,CAACF,QAAH,GAAcA,QAAd;AAEA,SAAOE,EAAP;AACD;;IAEYI,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAAA,kBACPC,cAAQ,CAAC,IAAD,CADD;AAAA,MAC1BC,KAD0B;AAAA,MACnBC,QADmB;;AAEjC,MAAIC,YAAY,GAAG,wBAAM,EAAzB;;AAGA,MAAMC,QAAQ,YAARA,QAAQ,CAAUC,CAAV;AAAA,QAAgB;AAC5B,UAAMC,WAAW,GAAG,EAApB;AACA,UAAMC,MAAM,GAAGF,CAAC,CAACE,MAAjB;;AAGA,WAAK,IAAMC,SAAX,IAAwBD,MAAM,CAACN,KAA/B,EAAsC;AAEpC,YAAIQ,KAAK,CAACD,SAAD,CAAT,EAAsB;AACpB;AACD;;AAGD,YAAME,IAAI,GAAGH,MAAM,CAACN,KAAP,CAAaO,SAAb,CAAb;AAIA,YAAMG,UAAU,GAAG;AACjBC,UAAAA,MAAM,EAAEC,GAAG,CAACC,eAAJ,CAAoBJ,IAApB,CADS;AAEjBK,UAAAA,IAAI,EAAEL,IAAI,CAACK,IAFM;AAGjBC,UAAAA,IAAI,EAAEN,IAAI,CAACM,IAHM;AAIjBN,UAAAA,IAAI,EAAJA;AAJiB,SAAnB;AAQAJ,QAAAA,WAAW,CAACW,IAAZ,CAAiBN,UAAjB;AACD;;AAGDJ,MAAAA,MAAM,CAACW,mBAAP,CAA2B,QAA3B,EAAqCd,QAArC;AAGAG,MAAAA,MAAM,CAACY,MAAP;;AAIA,UAAIZ,MAAM,CAACd,QAAX,EAAqB;AACnBS,QAAAA,QAAQ,CAACI,WAAD,CAAR;AACA,+BAAOH,YAAY,CAACG,WAAD,CAAnB;AACD;;AAEDJ,MAAAA,QAAQ,CAACI,WAAW,CAAC,CAAD,CAAZ,CAAR;AACA,6BAAOH,YAAY,CAACG,WAAW,CAAC,CAAD,CAAZ,CAAnB;AAGD,KA5Ca;AAAA;AAAA;AAAA,GAAd;;AA+CA,MAAMc,UAAU,GAAG,SAAbA,UAAa,QAEjBC,EAFiB,EAGd;AAAA,mCAFoB;AAAE3B,MAAAA,MAAM,EAAE,EAAV;AAAcD,MAAAA,QAAQ,EAAE;AAAxB,KAEpB;AAAA,QAFDC,MAEC,SAFDA,MAEC;AAAA,QAFOD,QAEP,SAFOA,QAEP;;AACH,QAAI,OAAO4B,EAAP,KAAc,UAAlB,EAA8B;AAC5BlB,MAAAA,YAAY,GAAGkB,EAAf;AACD;;AAED,QAAMC,OAAO,GAAG9B,oBAAoB,CAAC;AAAEC,MAAAA,QAAQ,EAARA,QAAF;AAAYC,MAAAA,MAAM,EAANA;AAAZ,KAAD,CAApC;AAEA4B,IAAAA,OAAO,CAACC,gBAAR,CAAyB,QAAzB,EAAmCnB,QAAnC;AACAkB,IAAAA,OAAO,CAACE,KAAR;AACD,GAZD;;AAcA,SAAOC,cAAK,CAACC,OAAN,CAAc;AAAA,WAAM,CAACzB,KAAD,EAAQmB,UAAR,CAAN;AAAA,GAAd,EAAyC,CAACnB,KAAD,CAAzC,CAAP;AACD;;;;"}